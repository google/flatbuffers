// <auto-generated>
//  automatically generated by the FlatBuffers compiler, do not modify
// </auto-generated>

namespace MyGame.Example
{

using global::System;
using global::System.Buffers;
using global::System.Collections.Generic;
using global::System.Runtime.InteropServices;
using global::Google.FlatSpanBuffers;
using global::Google.FlatSpanBuffers.Operations;
using global::Google.FlatSpanBuffers.Utils;
using global::Google.FlatSpanBuffers.Vectors;
public struct Movie : IFlatbufferObject
{
  private Table __p;
  public ByteBuffer ByteBuffer { get { return __p.bb; } }
  public static void ValidateVersion() { FlatBufferConstants.FLATBUFFERS_25_2_10(); }
  public static Movie GetRootAsMovie(ByteBuffer _bb) { return GetRootAsMovie(_bb, new Movie()); }
  public static Movie GetRootAsMovie(ByteBuffer _bb, Movie obj) { return (obj.__assign(_bb.Get<int>(_bb.Position) + _bb.Position, _bb)); }
  public static bool MovieBufferHasIdentifier(ByteBuffer _bb) { return Table.__has_identifier(_bb, "MOVI"); }
  public static bool VerifyMovie(ByteBuffer _bb) {Google.FlatSpanBuffers.Verifier verifier = new Google.FlatSpanBuffers.Verifier(_bb); return verifier.VerifyBuffer("MOVI", false, MyGame.Example.MovieVerify.Verify); }
  public void __init(int _i, ByteBuffer _bb) { __p = new Table(_i, _bb); }
  public Movie __assign(int _i, ByteBuffer _bb) { __init(_i, _bb); return this; }

  public MyGame.Example.Character MainCharacterType { get { int o = __p.__offset(4); return o != 0 ? (MyGame.Example.Character)__p.bb.Get<byte>(o + __p.bb_pos) : MyGame.Example.Character.NONE; } }
  public TTable? MainCharacter<TTable>() where TTable : struct, IFlatbufferObject { int o = __p.__offset(6); return o != 0 ? (TTable?)__p.__union<TTable>(o + __p.bb_pos) : null; }
  public string MainCharacterAsString() { int o = __p.__offset(6); return o != 0 ? __p.__string(o + __p.bb_pos) : null; }
  public MyGame.Example.Attacker MainCharacterAsMuLan() { return MainCharacter<MyGame.Example.Attacker>().Value; }
  public MyGame.Example.Rapunzel MainCharacterAsRapunzel() { return MainCharacter<MyGame.Example.Rapunzel>().Value; }
  public MyGame.Example.BookReader MainCharacterAsBelle() { return MainCharacter<MyGame.Example.BookReader>().Value; }
  public MyGame.Example.BookReader MainCharacterAsBookFan() { return MainCharacter<MyGame.Example.BookReader>().Value; }
  public string MainCharacterAsOther() { return MainCharacterAsString(); }
  public string MainCharacterAsUnused() { return MainCharacterAsString(); }
  public RefStructNullable<ReadOnlySpan<MyGame.Example.Character>> CharactersType { get { int o = __p.__offset(8); return o != 0 ? new RefStructNullable<ReadOnlySpan<MyGame.Example.Character>>(__p.__vector_as_span<MyGame.Example.Character>(8)) : default; } }
  public UnionVector? Characters { get { int o = __p.__offset(10); return o != 0 ? new UnionVector(__p, o, 4) : null; } }

  public static Offset<MyGame.Example.Movie> CreateMovie(FlatBufferBuilder builder,
      MyGame.Example.Character main_character_type = MyGame.Example.Character.NONE,
      int main_characterOffset = 0,
      VectorOffset characters_typeOffset = default(VectorOffset),
      VectorOffset charactersOffset = default(VectorOffset)) {
    builder.StartTable(4);
    Movie.AddCharacters(builder, charactersOffset);
    Movie.AddCharactersType(builder, characters_typeOffset);
    Movie.AddMainCharacter(builder, main_characterOffset);
    Movie.AddMainCharacterType(builder, main_character_type);
    return Movie.EndMovie(builder);
  }

  public static void StartMovie(FlatBufferBuilder builder) { builder.StartTable(4); }
  public static void AddMainCharacterType(FlatBufferBuilder builder, MyGame.Example.Character mainCharacterType) { builder.Add<byte>(0, (byte)mainCharacterType, 0); }
  public static void AddMainCharacter(FlatBufferBuilder builder, int mainCharacterOffset) { builder.AddOffset(1, mainCharacterOffset, 0); }
  public static void AddCharactersType(FlatBufferBuilder builder, VectorOffset charactersTypeOffset) { builder.AddOffset(2, charactersTypeOffset, 0); }
  public static VectorOffset CreateCharactersTypeVectorBlock(FlatBufferBuilder builder, Span<MyGame.Example.Character> data) { builder.StartVector(1, data.Length, 1); builder.AddSpan<MyGame.Example.Character>(data); return builder.EndVector(); }
  public static VectorOffset CreateCharactersTypeVector(FlatBufferBuilder builder, Span<MyGame.Example.Character> data) { return CreateCharactersTypeVectorBlock(builder, data); }
  public static void StartCharactersTypeVector(FlatBufferBuilder builder, int numElems) { builder.StartVector(1, numElems, 1); }
  public static void AddCharacters(FlatBufferBuilder builder, VectorOffset charactersOffset) { builder.AddOffset(3, charactersOffset, 0); }
  public static VectorOffset CreateCharactersVectorBlock(FlatBufferBuilder builder, Span<int> data) { builder.StartVector(4, data.Length, 4); builder.AddOffsetSpan(data); return builder.EndVector(); }
  public static VectorOffset CreateCharactersVector(FlatBufferBuilder builder, Span<int> data) { return CreateCharactersVectorBlock(builder, data); }
  public static void StartCharactersVector(FlatBufferBuilder builder, int numElems) { builder.StartVector(4, numElems, 4); }
  public static Offset<MyGame.Example.Movie> EndMovie(FlatBufferBuilder builder) {
    int o = builder.EndTable();
    return new Offset<MyGame.Example.Movie>(o);
  }
  public static void FinishMovieBuffer(FlatBufferBuilder builder, Offset<MyGame.Example.Movie> offset) { builder.Finish(offset.Value, "MOVI"); }
  public static void FinishSizePrefixedMovieBuffer(FlatBufferBuilder builder, Offset<MyGame.Example.Movie> offset) { builder.FinishSizePrefixed(offset.Value, "MOVI"); }
  public MovieT UnPack() {
    var _o = new MovieT();
    this.UnPackTo(_o);
    return _o;
  }
  public void UnPackTo(MovieT _o) {
    if (_o.MainCharacter == null) {
      _o.MainCharacter = new MyGame.Example.CharacterUnion();
    }
    var _MainCharacterOldType = _o.MainCharacter.Type;
    _o.MainCharacter.Type = this.MainCharacterType;
    switch (this.MainCharacterType) {
      default:
        _o.MainCharacter.Value = null;
        break;
      case MyGame.Example.Character.MuLan:
        if (this.MainCharacter<MyGame.Example.Attacker>().HasValue) {
          if (_MainCharacterOldType == MyGame.Example.Character.MuLan) {
            this.MainCharacter<MyGame.Example.Attacker>().Value.UnPackTo((MyGame.Example.AttackerT)_o.MainCharacter.Value);
          } else {
            _o.MainCharacter.Value = this.MainCharacter<MyGame.Example.Attacker>().Value.UnPack();
          }
        } else {
          _o.MainCharacter.Value = null;
        }
        break;
      case MyGame.Example.Character.Rapunzel:
        if (this.MainCharacter<MyGame.Example.Rapunzel>().HasValue) {
          if (_MainCharacterOldType == MyGame.Example.Character.Rapunzel) {
            this.MainCharacter<MyGame.Example.Rapunzel>().Value.UnPackTo((MyGame.Example.RapunzelT)_o.MainCharacter.Value);
          } else {
            _o.MainCharacter.Value = this.MainCharacter<MyGame.Example.Rapunzel>().Value.UnPack();
          }
        } else {
          _o.MainCharacter.Value = null;
        }
        break;
      case MyGame.Example.Character.Belle:
        if (this.MainCharacter<MyGame.Example.BookReader>().HasValue) {
          if (_MainCharacterOldType == MyGame.Example.Character.Belle) {
            this.MainCharacter<MyGame.Example.BookReader>().Value.UnPackTo((MyGame.Example.BookReaderT)_o.MainCharacter.Value);
          } else {
            _o.MainCharacter.Value = this.MainCharacter<MyGame.Example.BookReader>().Value.UnPack();
          }
        } else {
          _o.MainCharacter.Value = null;
        }
        break;
      case MyGame.Example.Character.BookFan:
        if (this.MainCharacter<MyGame.Example.BookReader>().HasValue) {
          if (_MainCharacterOldType == MyGame.Example.Character.BookFan) {
            this.MainCharacter<MyGame.Example.BookReader>().Value.UnPackTo((MyGame.Example.BookReaderT)_o.MainCharacter.Value);
          } else {
            _o.MainCharacter.Value = this.MainCharacter<MyGame.Example.BookReader>().Value.UnPack();
          }
        } else {
          _o.MainCharacter.Value = null;
        }
        break;
      case MyGame.Example.Character.Other:
        _o.MainCharacter.Value = this.MainCharacterAsString();
        break;
      case MyGame.Example.Character.Unused:
        _o.MainCharacter.Value = this.MainCharacterAsString();
        break;
    }
    var _characters_types = this.CharactersType;
    var _characters = this.Characters;
    var _characters_len = _characters.HasValue ? _characters.Value.Length : 0;
    if (_o.Characters == null) {
      _o.Characters = new List<MyGame.Example.CharacterUnion>(_characters_len);
    }
    ObjectApiUtil.ResizeList(_o.Characters, _characters_len);
    if (_characters.HasValue) {
      var _characters_value = _characters.Value;
      var _characters_types_value = _characters_types.Value;
      for (var _j = 0; _j < _characters_len; ++_j) {
        var _characters_type = _characters_types_value[_j];
        var _o_Characters = _o.Characters[_j];
        if (_o_Characters == null) {
          _o_Characters = new MyGame.Example.CharacterUnion();
          _o.Characters[_j] = _o_Characters;
        }
        var _characters_old_type = _o_Characters.Type;
        _o_Characters.Type = _characters_type;
        switch (_characters_type) {
          default:
            _o_Characters.Value = null;
            break;
          case MyGame.Example.Character.MuLan:
            if (_characters_old_type == MyGame.Example.Character.MuLan) {
              _characters_value.GetAs<MyGame.Example.Attacker>(_j).UnPackTo((MyGame.Example.AttackerT)_o_Characters.Value);
            } else {
              _o_Characters.Value = _characters_value.GetAs<MyGame.Example.Attacker>(_j).UnPack();
            }
            break;
          case MyGame.Example.Character.Rapunzel:
            if (_characters_old_type == MyGame.Example.Character.Rapunzel) {
              _characters_value.GetAs<MyGame.Example.Rapunzel>(_j).UnPackTo((MyGame.Example.RapunzelT)_o_Characters.Value);
            } else {
              _o_Characters.Value = _characters_value.GetAs<MyGame.Example.Rapunzel>(_j).UnPack();
            }
            break;
          case MyGame.Example.Character.Belle:
            if (_characters_old_type == MyGame.Example.Character.Belle) {
              _characters_value.GetAs<MyGame.Example.BookReader>(_j).UnPackTo((MyGame.Example.BookReaderT)_o_Characters.Value);
            } else {
              _o_Characters.Value = _characters_value.GetAs<MyGame.Example.BookReader>(_j).UnPack();
            }
            break;
          case MyGame.Example.Character.BookFan:
            if (_characters_old_type == MyGame.Example.Character.BookFan) {
              _characters_value.GetAs<MyGame.Example.BookReader>(_j).UnPackTo((MyGame.Example.BookReaderT)_o_Characters.Value);
            } else {
              _o_Characters.Value = _characters_value.GetAs<MyGame.Example.BookReader>(_j).UnPack();
            }
            break;
          case MyGame.Example.Character.Other:
            _o_Characters.Value = _characters_value.GetAsString(_j);
            break;
          case MyGame.Example.Character.Unused:
            _o_Characters.Value = _characters_value.GetAsString(_j);
            break;
        }
      }
    }
  }
  public static Offset<MyGame.Example.Movie> Pack(FlatBufferBuilder builder, MovieT _o) {
    if (_o == null) return default(Offset<MyGame.Example.Movie>);
    var _main_character_type = _o.MainCharacter == null ? MyGame.Example.Character.NONE : _o.MainCharacter.Type;
    var _main_character = _o.MainCharacter == null ? 0 : MyGame.Example.CharacterUnion.Pack(builder, _o.MainCharacter);
    var _characters_type = default(VectorOffset);
    if (_o.Characters != null) {
      var _characters_type_len = _o.Characters.Count;
      MyGame.Example.Character[] _characters_type_arr = null;
      try {
        Span<MyGame.Example.Character> __characters_type = _characters_type_len <= 256
          ? stackalloc MyGame.Example.Character[_characters_type_len]
          : (_characters_type_arr = ArrayPool<MyGame.Example.Character>.Shared.Rent(_characters_type_len)).AsSpan(0, _characters_type_len);
        for (var _j = 0; _j < _characters_type_len; ++_j) { __characters_type[_j] = _o.Characters[_j].Type; }
        _characters_type = CreateCharactersTypeVector(builder, __characters_type);
      } finally {
        if (_characters_type_arr != null) { ArrayPool<MyGame.Example.Character>.Shared.Return(_characters_type_arr); }
      }
    }
    var _characters = default(VectorOffset);
    if (_o.Characters != null) {
      var _characters_len = _o.Characters.Count;
      int[] _characters_arr = null;
      try {
        Span<int> __characters = _characters_len <= 64
          ? stackalloc int[_characters_len]
          : (_characters_arr = ArrayPool<int>.Shared.Rent(_characters_len)).AsSpan(0, _characters_len);
        for (var _j = 0; _j < _characters_len; ++_j) { __characters[_j] = MyGame.Example.CharacterUnion.Pack(builder,  _o.Characters[_j]); }
        _characters = CreateCharactersVector(builder, __characters);
      } finally {
        if (_characters_arr != null) { ArrayPool<int>.Shared.Return(_characters_arr); }
      }
    }
    return CreateMovie(
      builder,
      _main_character_type,
      _main_character,
      _characters_type,
      _characters);
  }
}

public class MovieT
{
  [System.Text.Json.Serialization.JsonPropertyName("main_character_type")]
  private MyGame.Example.Character MainCharacterType {
    get {
      return this.MainCharacter != null ? this.MainCharacter.Type : MyGame.Example.Character.NONE;
    }
    set {
      this.MainCharacter = new MyGame.Example.CharacterUnion();
      this.MainCharacter.Type = value;
    }
  }
  [System.Text.Json.Serialization.JsonPropertyName("main_character")]
  [System.Text.Json.Serialization.JsonConverter(typeof(MyGame.Example.CharacterUnion_JsonConverter))]
  public MyGame.Example.CharacterUnion MainCharacter { get; set; }
  [System.Text.Json.Serialization.JsonPropertyName("characters_type")]
  private MyGame.Example.Character[] CharactersType {
    get {
      if (this.Characters == null) return null;
      var _o = new MyGame.Example.Character[this.Characters.Count];
      for (var _j = 0; _j < _o.Length; ++_j) { _o[_j] = this.Characters[_j].Type; }
      return _o;
    }
    set {
      this.Characters = new List<MyGame.Example.CharacterUnion>();
      for (var _j = 0; _j < value.Length; ++_j) {
        var _o = new MyGame.Example.CharacterUnion();
        _o.Type = value[_j];
        this.Characters.Add(_o);
      }
    }
  }
  [System.Text.Json.Serialization.JsonPropertyName("characters")]
  public List<MyGame.Example.CharacterUnion> Characters { get; set; }

  public MovieT() {
    this.MainCharacter = null;
    this.Characters = null;
  }

  private static readonly System.Text.Json.JsonSerializerOptions _jsonOptions = new System.Text.Json.JsonSerializerOptions { WriteIndented = true, NumberHandling = System.Text.Json.Serialization.JsonNumberHandling.AllowNamedFloatingPointLiterals, Converters = { new System.Text.Json.Serialization.JsonStringEnumConverter() } };
  public static MovieT DeserializeFromJson(string jsonText) {
    return System.Text.Json.JsonSerializer.Deserialize<MovieT>(jsonText, _jsonOptions);
  }
  public string SerializeToJson() {
    return System.Text.Json.JsonSerializer.Serialize(this, _jsonOptions);
  }
  public static MovieT DeserializeFromBinary(byte[] fbBuffer) {
    return Movie.GetRootAsMovie(new ByteBuffer(fbBuffer)).UnPack();
  }
  public byte[] SerializeToBinary() {
    var fbb = new FlatBufferBuilder(0x10000);
    Movie.FinishMovieBuffer(fbb, Movie.Pack(fbb, this));
    return fbb.DataBuffer.ToSizedSpan().ToArray();
  }
}


static public class MovieVerify
{
  static public bool Verify(ref Google.FlatSpanBuffers.Verifier verifier, uint tablePos)
  {
    return verifier.VerifyTableStart(tablePos)
      && verifier.VerifyField(tablePos, 4 /*MainCharacterType*/, 1 /*MyGame.Example.Character*/, 1, false)
      && verifier.VerifyUnion(tablePos, 4, 6 /*MainCharacter*/, MyGame.Example.CharacterVerify.Verify, false)
      && verifier.VerifyVectorOfData(tablePos, 8 /*CharactersType*/, 1 /*MyGame.Example.Character*/, false)
      && verifier.VerifyTableEnd(tablePos);
  }
}

}
