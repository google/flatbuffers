// <auto-generated>
//  automatically generated by the FlatBuffers compiler, do not modify
// </auto-generated>

namespace MyGame.Example.StackBuffer
{

using global::System;
using global::System.Buffers;
using global::System.Collections.Generic;
using global::System.Runtime.InteropServices;
using global::Google.FlatSpanBuffers;
using global::Google.FlatSpanBuffers.Operations;
using global::Google.FlatSpanBuffers.Utils;
using global::Google.FlatSpanBuffers.Vectors;
public ref struct Movie : IFlatbufferSpanObject
{
  private TableSpan __p;
  public ByteSpanBuffer ByteBuffer { get { return __p.bb; } }
  public static void ValidateVersion() { FlatBufferConstants.FLATBUFFERS_25_2_10(); }
  public static Movie GetRootAsMovie(ByteSpanBuffer _bb) { return GetRootAsMovie(_bb, new Movie()); }
  public static Movie GetRootAsMovie(ByteSpanBuffer _bb, Movie obj) { return (obj.__assign(_bb.Get<int>(_bb.Position) + _bb.Position, _bb)); }
  public static bool MovieBufferHasIdentifier(ByteSpanBuffer _bb) { return TableSpan.__has_identifier(_bb, "MOVI"); }
  public static bool VerifyMovie(ByteSpanBuffer _bb) {Google.FlatSpanBuffers.Verifier verifier = new Google.FlatSpanBuffers.Verifier(_bb); return verifier.VerifyBuffer("MOVI", false, MyGame.Example.MovieVerify.Verify); }
  public void __init(int _i, ByteSpanBuffer _bb) { __p = new TableSpan(_i, _bb); }
  public Movie __assign(int _i, ByteSpanBuffer _bb) { __init(_i, _bb); return this; }

  public MyGame.Example.Character MainCharacterType { get { int o = __p.__offset(4); return o != 0 ? (MyGame.Example.Character)__p.bb.Get<byte>(o + __p.bb_pos) : MyGame.Example.Character.NONE; } }
  public RefStructNullable<TTable> MainCharacter<TTable>() where TTable : struct, IFlatbufferSpanObject, allows ref struct { int o = __p.__offset(6); return o != 0 ? new RefStructNullable<TTable>(__p.__union<TTable>(o + __p.bb_pos)) : default; }
  public string MainCharacterAsString() { int o = __p.__offset(6); return o != 0 ? __p.__string(o + __p.bb_pos) : null; }
  public MyGame.Example.StackBuffer.Attacker MainCharacterAsMuLan() { return MainCharacter<MyGame.Example.StackBuffer.Attacker>().Value; }
  public MyGame.Example.StackBuffer.Rapunzel MainCharacterAsRapunzel() { return MainCharacter<MyGame.Example.StackBuffer.Rapunzel>().Value; }
  public MyGame.Example.StackBuffer.BookReader MainCharacterAsBelle() { return MainCharacter<MyGame.Example.StackBuffer.BookReader>().Value; }
  public MyGame.Example.StackBuffer.BookReader MainCharacterAsBookFan() { return MainCharacter<MyGame.Example.StackBuffer.BookReader>().Value; }
  public string MainCharacterAsOther() { return MainCharacterAsString(); }
  public string MainCharacterAsUnused() { return MainCharacterAsString(); }
  public RefStructNullable<ReadOnlySpan<MyGame.Example.Character>> CharactersType { get { int o = __p.__offset(8); return o != 0 ? new RefStructNullable<ReadOnlySpan<MyGame.Example.Character>>(__p.__vector_as_span<MyGame.Example.Character>(8)) : default; } }
  public RefStructNullable<UnionVectorSpan> Characters { get { int o = __p.__offset(10); return o != 0 ? new RefStructNullable<UnionVectorSpan>(new UnionVectorSpan(__p, o, 4)) : default; } }

  public static Offset<MyGame.Example.StackBuffer.Movie> CreateMovie(ref FlatSpanBufferBuilder builder,
      MyGame.Example.Character main_character_type = MyGame.Example.Character.NONE,
      int main_characterOffset = 0,
      VectorOffset characters_typeOffset = default(VectorOffset),
      VectorOffset charactersOffset = default(VectorOffset)) {
    builder.StartTable(4);
    Movie.AddCharacters(ref builder, charactersOffset);
    Movie.AddCharactersType(ref builder, characters_typeOffset);
    Movie.AddMainCharacter(ref builder, main_characterOffset);
    Movie.AddMainCharacterType(ref builder, main_character_type);
    return Movie.EndMovie(ref builder);
  }

  public static void StartMovie(ref FlatSpanBufferBuilder builder) { builder.StartTable(4); }
  public static void AddMainCharacterType(ref FlatSpanBufferBuilder builder, MyGame.Example.Character mainCharacterType) { builder.Add<byte>(0, (byte)mainCharacterType, 0); }
  public static void AddMainCharacter(ref FlatSpanBufferBuilder builder, int mainCharacterOffset) { builder.AddOffset(1, mainCharacterOffset, 0); }
  public static void AddCharactersType(ref FlatSpanBufferBuilder builder, VectorOffset charactersTypeOffset) { builder.AddOffset(2, charactersTypeOffset, 0); }
  public static VectorOffset CreateCharactersTypeVectorBlock(ref FlatSpanBufferBuilder builder, scoped Span<MyGame.Example.Character> data) { builder.StartVector(1, data.Length, 1); builder.AddSpan<MyGame.Example.Character>(data); return builder.EndVector(); }
  public static VectorOffset CreateCharactersTypeVector(ref FlatSpanBufferBuilder builder, scoped Span<MyGame.Example.Character> data) { return CreateCharactersTypeVectorBlock(ref builder, data); }
  public static void StartCharactersTypeVector(ref FlatSpanBufferBuilder builder, int numElems) { builder.StartVector(1, numElems, 1); }
  public static void AddCharacters(ref FlatSpanBufferBuilder builder, VectorOffset charactersOffset) { builder.AddOffset(3, charactersOffset, 0); }
  public static VectorOffset CreateCharactersVectorBlock(ref FlatSpanBufferBuilder builder, scoped Span<int> data) { builder.StartVector(4, data.Length, 4); builder.AddOffsetSpan(data); return builder.EndVector(); }
  public static VectorOffset CreateCharactersVector(ref FlatSpanBufferBuilder builder, scoped Span<int> data) { return CreateCharactersVectorBlock(ref builder, data); }
  public static void StartCharactersVector(ref FlatSpanBufferBuilder builder, int numElems) { builder.StartVector(4, numElems, 4); }
  public static Offset<MyGame.Example.StackBuffer.Movie> EndMovie(ref FlatSpanBufferBuilder builder) {
    int o = builder.EndTable();
    return new Offset<MyGame.Example.StackBuffer.Movie>(o);
  }
  public static void FinishMovieBuffer(ref FlatSpanBufferBuilder builder, Offset<MyGame.Example.StackBuffer.Movie> offset) { builder.Finish(offset.Value, "MOVI"); }
  public static void FinishSizePrefixedMovieBuffer(ref FlatSpanBufferBuilder builder, Offset<MyGame.Example.StackBuffer.Movie> offset) { builder.FinishSizePrefixed(offset.Value, "MOVI"); }
  public MovieT UnPack() {
    var _o = new MovieT();
    this.UnPackTo(_o);
    return _o;
  }
  public void UnPackTo(MovieT _o) {
    if (_o.MainCharacter == null) {
      _o.MainCharacter = new MyGame.Example.CharacterUnion();
    }
    var _MainCharacterOldType = _o.MainCharacter.Type;
    _o.MainCharacter.Type = this.MainCharacterType;
    switch (this.MainCharacterType) {
      default:
        _o.MainCharacter.Value = null;
        break;
      case MyGame.Example.Character.MuLan:
        if (this.MainCharacter<MyGame.Example.StackBuffer.Attacker>().HasValue) {
          if (_MainCharacterOldType == MyGame.Example.Character.MuLan) {
            this.MainCharacter<MyGame.Example.StackBuffer.Attacker>().Value.UnPackTo((MyGame.Example.AttackerT)_o.MainCharacter.Value);
          } else {
            _o.MainCharacter.Value = this.MainCharacter<MyGame.Example.StackBuffer.Attacker>().Value.UnPack();
          }
        } else {
          _o.MainCharacter.Value = null;
        }
        break;
      case MyGame.Example.Character.Rapunzel:
        if (this.MainCharacter<MyGame.Example.StackBuffer.Rapunzel>().HasValue) {
          if (_MainCharacterOldType == MyGame.Example.Character.Rapunzel) {
            this.MainCharacter<MyGame.Example.StackBuffer.Rapunzel>().Value.UnPackTo((MyGame.Example.RapunzelT)_o.MainCharacter.Value);
          } else {
            _o.MainCharacter.Value = this.MainCharacter<MyGame.Example.StackBuffer.Rapunzel>().Value.UnPack();
          }
        } else {
          _o.MainCharacter.Value = null;
        }
        break;
      case MyGame.Example.Character.Belle:
        if (this.MainCharacter<MyGame.Example.StackBuffer.BookReader>().HasValue) {
          if (_MainCharacterOldType == MyGame.Example.Character.Belle) {
            this.MainCharacter<MyGame.Example.StackBuffer.BookReader>().Value.UnPackTo((MyGame.Example.BookReaderT)_o.MainCharacter.Value);
          } else {
            _o.MainCharacter.Value = this.MainCharacter<MyGame.Example.StackBuffer.BookReader>().Value.UnPack();
          }
        } else {
          _o.MainCharacter.Value = null;
        }
        break;
      case MyGame.Example.Character.BookFan:
        if (this.MainCharacter<MyGame.Example.StackBuffer.BookReader>().HasValue) {
          if (_MainCharacterOldType == MyGame.Example.Character.BookFan) {
            this.MainCharacter<MyGame.Example.StackBuffer.BookReader>().Value.UnPackTo((MyGame.Example.BookReaderT)_o.MainCharacter.Value);
          } else {
            _o.MainCharacter.Value = this.MainCharacter<MyGame.Example.StackBuffer.BookReader>().Value.UnPack();
          }
        } else {
          _o.MainCharacter.Value = null;
        }
        break;
      case MyGame.Example.Character.Other:
        _o.MainCharacter.Value = this.MainCharacterAsString();
        break;
      case MyGame.Example.Character.Unused:
        _o.MainCharacter.Value = this.MainCharacterAsString();
        break;
    }
    var _characters_types = this.CharactersType;
    var _characters = this.Characters;
    var _characters_len = _characters.HasValue ? _characters.Value.Length : 0;
    if (_o.Characters == null) {
      _o.Characters = new List<MyGame.Example.CharacterUnion>(_characters_len);
    }
    ObjectApiUtil.ResizeList(_o.Characters, _characters_len);
    if (_characters.HasValue) {
      var _characters_value = _characters.Value;
      var _characters_types_value = _characters_types.Value;
      for (var _j = 0; _j < _characters_len; ++_j) {
        var _characters_type = _characters_types_value[_j];
        var _o_Characters = _o.Characters[_j];
        if (_o_Characters == null) {
          _o_Characters = new MyGame.Example.CharacterUnion();
          _o.Characters[_j] = _o_Characters;
        }
        var _characters_old_type = _o_Characters.Type;
        _o_Characters.Type = _characters_type;
        switch (_characters_type) {
          default:
            _o_Characters.Value = null;
            break;
          case MyGame.Example.Character.MuLan:
            if (_characters_old_type == MyGame.Example.Character.MuLan) {
              _characters_value.GetAs<MyGame.Example.StackBuffer.Attacker>(_j).UnPackTo((MyGame.Example.AttackerT)_o_Characters.Value);
            } else {
              _o_Characters.Value = _characters_value.GetAs<MyGame.Example.StackBuffer.Attacker>(_j).UnPack();
            }
            break;
          case MyGame.Example.Character.Rapunzel:
            if (_characters_old_type == MyGame.Example.Character.Rapunzel) {
              _characters_value.GetAs<MyGame.Example.StackBuffer.Rapunzel>(_j).UnPackTo((MyGame.Example.RapunzelT)_o_Characters.Value);
            } else {
              _o_Characters.Value = _characters_value.GetAs<MyGame.Example.StackBuffer.Rapunzel>(_j).UnPack();
            }
            break;
          case MyGame.Example.Character.Belle:
            if (_characters_old_type == MyGame.Example.Character.Belle) {
              _characters_value.GetAs<MyGame.Example.StackBuffer.BookReader>(_j).UnPackTo((MyGame.Example.BookReaderT)_o_Characters.Value);
            } else {
              _o_Characters.Value = _characters_value.GetAs<MyGame.Example.StackBuffer.BookReader>(_j).UnPack();
            }
            break;
          case MyGame.Example.Character.BookFan:
            if (_characters_old_type == MyGame.Example.Character.BookFan) {
              _characters_value.GetAs<MyGame.Example.StackBuffer.BookReader>(_j).UnPackTo((MyGame.Example.BookReaderT)_o_Characters.Value);
            } else {
              _o_Characters.Value = _characters_value.GetAs<MyGame.Example.StackBuffer.BookReader>(_j).UnPack();
            }
            break;
          case MyGame.Example.Character.Other:
            _o_Characters.Value = _characters_value.GetAsString(_j);
            break;
          case MyGame.Example.Character.Unused:
            _o_Characters.Value = _characters_value.GetAsString(_j);
            break;
        }
      }
    }
  }
  public static Offset<MyGame.Example.StackBuffer.Movie> Pack(ref FlatSpanBufferBuilder builder, MovieT _o) {
    if (_o == null) return default(Offset<MyGame.Example.StackBuffer.Movie>);
    var _main_character_type = _o.MainCharacter == null ? MyGame.Example.Character.NONE : _o.MainCharacter.Type;
    var _main_character = _o.MainCharacter == null ? 0 : MyGame.Example.CharacterUnion.Pack(ref builder, _o.MainCharacter);
    var _characters_type = default(VectorOffset);
    if (_o.Characters != null) {
      var _characters_type_len = _o.Characters.Count;
      MyGame.Example.Character[] _characters_type_arr = null;
      try {
        Span<MyGame.Example.Character> __characters_type = _characters_type_len <= 256
          ? stackalloc MyGame.Example.Character[_characters_type_len]
          : (_characters_type_arr = ArrayPool<MyGame.Example.Character>.Shared.Rent(_characters_type_len)).AsSpan(0, _characters_type_len);
        for (var _j = 0; _j < _characters_type_len; ++_j) { __characters_type[_j] = _o.Characters[_j].Type; }
        _characters_type = CreateCharactersTypeVector(ref builder, __characters_type);
      } finally {
        if (_characters_type_arr != null) { ArrayPool<MyGame.Example.Character>.Shared.Return(_characters_type_arr); }
      }
    }
    var _characters = default(VectorOffset);
    if (_o.Characters != null) {
      var _characters_len = _o.Characters.Count;
      int[] _characters_arr = null;
      try {
        Span<int> __characters = _characters_len <= 64
          ? stackalloc int[_characters_len]
          : (_characters_arr = ArrayPool<int>.Shared.Rent(_characters_len)).AsSpan(0, _characters_len);
        for (var _j = 0; _j < _characters_len; ++_j) { __characters[_j] = MyGame.Example.CharacterUnion.Pack(ref builder,  _o.Characters[_j]); }
        _characters = CreateCharactersVector(ref builder, __characters);
      } finally {
        if (_characters_arr != null) { ArrayPool<int>.Shared.Return(_characters_arr); }
      }
    }
    return CreateMovie(
      ref builder,
      _main_character_type,
      _main_character,
      _characters_type,
      _characters);
  }
}


}
