// <auto-generated>
//  automatically generated by the FlatBuffers compiler, do not modify
// </auto-generated>

namespace JsonTest
{

using global::System;
using global::System.Buffers;
using global::System.Collections.Generic;
using global::System.Runtime.InteropServices;
using global::Google.FlatSpanBuffers;
using global::Google.FlatSpanBuffers.Operations;
using global::Google.FlatSpanBuffers.Utils;
using global::Google.FlatSpanBuffers.Vectors;
public struct GameState : IFlatbufferObject
{
  private Table __p;
  public ByteBuffer ByteBuffer { get { return __p.bb; } }
  public static void ValidateVersion() { FlatBufferConstants.FLATBUFFERS_25_2_10(); }
  public static GameState GetRootAsGameState(ByteBuffer _bb) { return GetRootAsGameState(_bb, new GameState()); }
  public static GameState GetRootAsGameState(ByteBuffer _bb, GameState obj) { return (obj.__assign(_bb.Get<int>(_bb.Position) + _bb.Position, _bb)); }
  public static bool GameStateBufferHasIdentifier(ByteBuffer _bb) { return Table.__has_identifier(_bb, "JSON"); }
  public static bool VerifyGameState(ByteBuffer _bb) {Google.FlatSpanBuffers.Verifier verifier = new Google.FlatSpanBuffers.Verifier(_bb); return verifier.VerifyBuffer("JSON", false, JsonTest.GameStateVerify.Verify); }
  public void __init(int _i, ByteBuffer _bb) { __p = new Table(_i, _bb); }
  public GameState __assign(int _i, ByteBuffer _bb) { __init(_i, _bb); return this; }

  public string Version { get { int o = __p.__offset(4); return o != 0 ? __p.__string(o + __p.bb_pos) : null; } }
  public ReadOnlySpan<byte> GetVersionBytes() { return __p.__vector_as_span<byte>(4); }
  public TableVector<JsonTest.Player>? Players { get { int o = __p.__offset(6); return o != 0 ? new TableVector<JsonTest.Player>(__p, o, 4) : null; } }
  public bool TryGetPlayersByKey(string key, out JsonTest.Player value) { int o = __p.__offset(6); if (o != 0) { return JsonTest.Player.TryGetByKey(__p.__vector(o), key, __p.bb, out value); } value = default; return false; }
  public long ActivePlayerId { get { int o = __p.__offset(8); return o != 0 ? __p.bb.Get<long>(o + __p.bb_pos) : (long)0; } }
  public long Timestamp { get { int o = __p.__offset(10); return o != 0 ? __p.bb.Get<long>(o + __p.bb_pos) : (long)0; } }

  public static Offset<JsonTest.GameState> CreateGameState(FlatBufferBuilder builder,
      StringOffset versionOffset = default(StringOffset),
      VectorOffset playersOffset = default(VectorOffset),
      long active_player_id = 0,
      long timestamp = 0) {
    builder.StartTable(4);
    GameState.AddTimestamp(builder, timestamp);
    GameState.AddActivePlayerId(builder, active_player_id);
    GameState.AddPlayers(builder, playersOffset);
    GameState.AddVersion(builder, versionOffset);
    return GameState.EndGameState(builder);
  }

  public static void StartGameState(FlatBufferBuilder builder) { builder.StartTable(4); }
  public static void AddVersion(FlatBufferBuilder builder, StringOffset versionOffset) { builder.AddOffset(0, versionOffset, 0); }
  public static void AddPlayers(FlatBufferBuilder builder, VectorOffset playersOffset) { builder.AddOffset(1, playersOffset, 0); }
  public static VectorOffset CreatePlayersVectorBlock(FlatBufferBuilder builder, Span<Offset<JsonTest.Player>> data) { builder.StartVector(4, data.Length, 4); builder.AddOffsetSpan<Offset<JsonTest.Player>>(data); return builder.EndVector(); }
  public static VectorOffset CreatePlayersVector(FlatBufferBuilder builder, Span<Offset<JsonTest.Player>> data) { return CreatePlayersVectorBlock(builder, data); }
  public static void StartPlayersVector(FlatBufferBuilder builder, int numElems) { builder.StartVector(4, numElems, 4); }
  public static void AddActivePlayerId(FlatBufferBuilder builder, long activePlayerId) { builder.Add<long>(2, activePlayerId, 0); }
  public static void AddTimestamp(FlatBufferBuilder builder, long timestamp) { builder.Add<long>(3, timestamp, 0); }
  public static Offset<JsonTest.GameState> EndGameState(FlatBufferBuilder builder) {
    int o = builder.EndTable();
    return new Offset<JsonTest.GameState>(o);
  }
  public static void FinishGameStateBuffer(FlatBufferBuilder builder, Offset<JsonTest.GameState> offset) { builder.Finish(offset.Value, "JSON"); }
  public static void FinishSizePrefixedGameStateBuffer(FlatBufferBuilder builder, Offset<JsonTest.GameState> offset) { builder.FinishSizePrefixed(offset.Value, "JSON"); }
  public GameStateT UnPack() {
    var _o = new GameStateT();
    this.UnPackTo(_o);
    return _o;
  }
  public void UnPackTo(GameStateT _o) {
    _o.Version = this.Version;
    var _players_vec = this.Players;
    var _players_len = _players_vec.HasValue ? _players_vec.Value.Length : 0;
    if (_o.Players == null) {
      _o.Players = new List<JsonTest.PlayerT>(_players_len);
    }
    ObjectApiUtil.ResizeList(_o.Players, _players_len);
    if (_players_vec.HasValue) {
      var _players_value = _players_vec.Value;
      for (var _j = 0; _j < _players_len; ++_j) {
        var _src = _players_value[_j];
        if (_o.Players[_j] == null) { _o.Players[_j] = new PlayerT(); }
        _src.UnPackTo(_o.Players[_j]);
      }
    }
    _o.ActivePlayerId = this.ActivePlayerId;
    _o.Timestamp = this.Timestamp;
  }
  public static Offset<JsonTest.GameState> Pack(FlatBufferBuilder builder, GameStateT _o) {
    if (_o == null) return default(Offset<JsonTest.GameState>);
    var _version = _o.Version == null ? default(StringOffset) : builder.CreateString(_o.Version);
    var _players = default(VectorOffset);
    if (_o.Players != null) {
      var _players_len = _o.Players.Count;
      Offset<JsonTest.Player>[] _players_arr = null;
      try {
        Span<Offset<JsonTest.Player>> __players = _players_len <= 64
          ? stackalloc Offset<JsonTest.Player>[_players_len]
          : (_players_arr = ArrayPool<Offset<JsonTest.Player>>.Shared.Rent(_players_len)).AsSpan(0, _players_len);
        for (var _j = 0; _j < _players_len; ++_j) { __players[_j] = JsonTest.Player.Pack(builder, _o.Players[_j]); }
        _players = CreatePlayersVector(builder, __players);
      } finally {
        if (_players_arr != null) { ArrayPool<Offset<JsonTest.Player>>.Shared.Return(_players_arr); }
      }
    }
    return CreateGameState(
      builder,
      _version,
      _players,
      _o.ActivePlayerId,
      _o.Timestamp);
  }
}

public class GameStateT
{
  [System.Text.Json.Serialization.JsonPropertyName("version")]
  public string Version { get; set; }
  [System.Text.Json.Serialization.JsonPropertyName("players")]
  public List<JsonTest.PlayerT> Players { get; set; }
  [System.Text.Json.Serialization.JsonPropertyName("active_player_id")]
  public long ActivePlayerId { get; set; }
  [System.Text.Json.Serialization.JsonPropertyName("timestamp")]
  public long Timestamp { get; set; }

  public GameStateT() {
    this.Version = null;
    this.Players = null;
    this.ActivePlayerId = 0;
    this.Timestamp = 0;
  }

  private static readonly System.Text.Json.JsonSerializerOptions _jsonOptions = new System.Text.Json.JsonSerializerOptions { WriteIndented = true, NumberHandling = System.Text.Json.Serialization.JsonNumberHandling.AllowNamedFloatingPointLiterals, Converters = { new System.Text.Json.Serialization.JsonStringEnumConverter() } };
  public static GameStateT DeserializeFromJson(string jsonText) {
    return System.Text.Json.JsonSerializer.Deserialize<GameStateT>(jsonText, _jsonOptions);
  }
  public string SerializeToJson() {
    return System.Text.Json.JsonSerializer.Serialize(this, _jsonOptions);
  }
  public static GameStateT DeserializeFromBinary(byte[] fbBuffer) {
    return GameState.GetRootAsGameState(new ByteBuffer(fbBuffer)).UnPack();
  }
  public byte[] SerializeToBinary() {
    var fbb = new FlatBufferBuilder(0x10000);
    GameState.FinishGameStateBuffer(fbb, GameState.Pack(fbb, this));
    return fbb.DataBuffer.ToSizedSpan().ToArray();
  }
}


static public class GameStateVerify
{
  static public bool Verify(ref Google.FlatSpanBuffers.Verifier verifier, uint tablePos)
  {
    return verifier.VerifyTableStart(tablePos)
      && verifier.VerifyString(tablePos, 4 /*Version*/, false)
      && verifier.VerifyVectorOfTables(tablePos, 6 /*Players*/, JsonTest.PlayerVerify.Verify, false)
      && verifier.VerifyField(tablePos, 8 /*ActivePlayerId*/, 8 /*long*/, 8, false)
      && verifier.VerifyField(tablePos, 10 /*Timestamp*/, 8 /*long*/, 8, false)
      && verifier.VerifyTableEnd(tablePos);
  }
}

}
