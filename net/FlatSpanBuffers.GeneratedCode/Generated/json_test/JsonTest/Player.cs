// <auto-generated>
//  automatically generated by the FlatBuffers compiler, do not modify
// </auto-generated>

namespace JsonTest
{

using global::System;
using global::System.Buffers;
using global::System.Collections.Generic;
using global::System.Runtime.InteropServices;
using global::Google.FlatSpanBuffers;
using global::Google.FlatSpanBuffers.Operations;
using global::Google.FlatSpanBuffers.Utils;
using global::Google.FlatSpanBuffers.Vectors;
public struct Player : IFlatbufferObject
{
  private Table __p;
  public ByteBuffer ByteBuffer { get { return __p.bb; } }
  public static void ValidateVersion() { FlatBufferConstants.FLATBUFFERS_25_2_10(); }
  public static Player GetRootAsPlayer(ByteBuffer _bb) { return GetRootAsPlayer(_bb, new Player()); }
  public static Player GetRootAsPlayer(ByteBuffer _bb, Player obj) { return (obj.__assign(_bb.Get<int>(_bb.Position) + _bb.Position, _bb)); }
  public void __init(int _i, ByteBuffer _bb) { __p = new Table(_i, _bb); }
  public Player __assign(int _i, ByteBuffer _bb) { __init(_i, _bb); return this; }

  public long Id { get { int o = __p.__offset(4); return o != 0 ? __p.bb.Get<long>(o + __p.bb_pos) : (long)0; } }
  public string Name { get { int o = __p.__offset(6); return o != 0 ? __p.__string(o + __p.bb_pos) : null; } }
  public ReadOnlySpan<byte> GetNameBytes() { return __p.__vector_as_span<byte>(6); }
  public int Level { get { int o = __p.__offset(8); return o != 0 ? __p.bb.Get<int>(o + __p.bb_pos) : (int)1; } }
  public float Health { get { int o = __p.__offset(10); return o != 0 ? __p.bb.Get<float>(o + __p.bb_pos) : (float)100.0f; } }
  public JsonTest.Vec2? Position { get { int o = __p.__offset(12); return o != 0 ? (JsonTest.Vec2?)(new JsonTest.Vec2()).__assign(o + __p.bb_pos, __p.bb) : null; } }
  public JsonTest.Status Status { get { int o = __p.__offset(14); return o != 0 ? (JsonTest.Status)__p.bb.Get<sbyte>(o + __p.bb_pos) : JsonTest.Status.Active; } }
  public JsonTest.Priority Priorities { get { int o = __p.__offset(16); return o != 0 ? (JsonTest.Priority)__p.bb.Get<byte>(o + __p.bb_pos) : 0; } }
  public TableVector<JsonTest.Item>? Inventory { get { int o = __p.__offset(18); return o != 0 ? new TableVector<JsonTest.Item>(__p, o, 4) : null; } }
  public bool TryGetInventoryByKey(int key, out JsonTest.Item value) { int o = __p.__offset(18); if (o != 0) { return JsonTest.Item.TryGetByKey(__p.__vector(o), key, __p.bb, out value); } value = default; return false; }
  public JsonTest.Equipment EquippedType { get { int o = __p.__offset(20); return o != 0 ? (JsonTest.Equipment)__p.bb.Get<byte>(o + __p.bb_pos) : JsonTest.Equipment.NONE; } }
  public TTable? Equipped<TTable>() where TTable : struct, IFlatbufferObject { int o = __p.__offset(22); return o != 0 ? (TTable?)__p.__union<TTable>(o + __p.bb_pos) : null; }
  public JsonTest.Weapon EquippedAsWeapon() { return Equipped<JsonTest.Weapon>().Value; }
  public JsonTest.Armor EquippedAsArmor() { return Equipped<JsonTest.Armor>().Value; }
  public StringVector? Tags { get { int o = __p.__offset(24); return o != 0 ? new StringVector(__p, o) : null; } }
  public RefStructNullable<ReadOnlySpan<int>> Scores { get { int o = __p.__offset(26); return o != 0 ? new RefStructNullable<ReadOnlySpan<int>>(__p.__vector_as_span<int>(26)) : default; } }
  public JsonTest.Color? Color { get { int o = __p.__offset(28); return o != 0 ? (JsonTest.Color?)(new JsonTest.Color()).__assign(o + __p.bb_pos, __p.bb) : null; } }

  public static Offset<JsonTest.Player> CreatePlayer(FlatBufferBuilder builder,
      long id = 0,
      StringOffset nameOffset = default(StringOffset),
      int level = 1,
      float health = 100.0f,
      JsonTest.Vec2T position = null,
      JsonTest.Status status = JsonTest.Status.Active,
      JsonTest.Priority priorities = 0,
      VectorOffset inventoryOffset = default(VectorOffset),
      JsonTest.Equipment equipped_type = JsonTest.Equipment.NONE,
      int equippedOffset = 0,
      VectorOffset tagsOffset = default(VectorOffset),
      VectorOffset scoresOffset = default(VectorOffset),
      JsonTest.ColorT color = null) {
    builder.StartTable(13);
    Player.AddId(builder, id);
    Player.AddColor(builder, JsonTest.Color.Pack(builder, color));
    Player.AddScores(builder, scoresOffset);
    Player.AddTags(builder, tagsOffset);
    Player.AddEquipped(builder, equippedOffset);
    Player.AddInventory(builder, inventoryOffset);
    Player.AddPosition(builder, JsonTest.Vec2.Pack(builder, position));
    Player.AddHealth(builder, health);
    Player.AddLevel(builder, level);
    Player.AddName(builder, nameOffset);
    Player.AddEquippedType(builder, equipped_type);
    Player.AddPriorities(builder, priorities);
    Player.AddStatus(builder, status);
    return Player.EndPlayer(builder);
  }

  public static void StartPlayer(FlatBufferBuilder builder) { builder.StartTable(13); }
  public static void AddId(FlatBufferBuilder builder, long id) { builder.Add<long>(0, id, 0); }
  public static void AddName(FlatBufferBuilder builder, StringOffset nameOffset) { builder.AddOffset(1, nameOffset, 0); }
  public static void AddLevel(FlatBufferBuilder builder, int level) { builder.Add<int>(2, level, 1); }
  public static void AddHealth(FlatBufferBuilder builder, float health) { builder.Add<float>(3, health, 100.0f); }
  public static void AddPosition(FlatBufferBuilder builder, Offset<JsonTest.Vec2> positionOffset) { builder.AddStruct(4, positionOffset, 0); }
  public static void AddStatus(FlatBufferBuilder builder, JsonTest.Status status) { builder.Add<sbyte>(5, (sbyte)status, 1); }
  public static void AddPriorities(FlatBufferBuilder builder, JsonTest.Priority priorities) { builder.Add<byte>(6, (byte)priorities, 0); }
  public static void AddInventory(FlatBufferBuilder builder, VectorOffset inventoryOffset) { builder.AddOffset(7, inventoryOffset, 0); }
  public static VectorOffset CreateInventoryVectorBlock(FlatBufferBuilder builder, Span<Offset<JsonTest.Item>> data) { builder.StartVector(4, data.Length, 4); builder.AddOffsetSpan<Offset<JsonTest.Item>>(data); return builder.EndVector(); }
  public static VectorOffset CreateInventoryVector(FlatBufferBuilder builder, Span<Offset<JsonTest.Item>> data) { return CreateInventoryVectorBlock(builder, data); }
  public static void StartInventoryVector(FlatBufferBuilder builder, int numElems) { builder.StartVector(4, numElems, 4); }
  public static void AddEquippedType(FlatBufferBuilder builder, JsonTest.Equipment equippedType) { builder.Add<byte>(8, (byte)equippedType, 0); }
  public static void AddEquipped(FlatBufferBuilder builder, int equippedOffset) { builder.AddOffset(9, equippedOffset, 0); }
  public static void AddTags(FlatBufferBuilder builder, VectorOffset tagsOffset) { builder.AddOffset(10, tagsOffset, 0); }
  public static VectorOffset CreateTagsVectorBlock(FlatBufferBuilder builder, Span<StringOffset> data) { builder.StartVector(4, data.Length, 4); builder.AddOffsetSpan<StringOffset>(data); return builder.EndVector(); }
  public static VectorOffset CreateTagsVector(FlatBufferBuilder builder, Span<StringOffset> data) { return CreateTagsVectorBlock(builder, data); }
  public static void StartTagsVector(FlatBufferBuilder builder, int numElems) { builder.StartVector(4, numElems, 4); }
  public static void AddScores(FlatBufferBuilder builder, VectorOffset scoresOffset) { builder.AddOffset(11, scoresOffset, 0); }
  public static VectorOffset CreateScoresVectorBlock(FlatBufferBuilder builder, Span<int> data) { builder.StartVector(4, data.Length, 4); builder.AddSpan<int>(data); return builder.EndVector(); }
  public static VectorOffset CreateScoresVector(FlatBufferBuilder builder, Span<int> data) { return CreateScoresVectorBlock(builder, data); }
  public static void StartScoresVector(FlatBufferBuilder builder, int numElems) { builder.StartVector(4, numElems, 4); }
  public static void AddColor(FlatBufferBuilder builder, Offset<JsonTest.Color> colorOffset) { builder.AddStruct(12, colorOffset, 0); }
  public static Offset<JsonTest.Player> EndPlayer(FlatBufferBuilder builder) {
    int o = builder.EndTable();
    builder.Required(o, 6);  // name
    return new Offset<JsonTest.Player>(o);
  }

  public static VectorOffset CreateSortedVectorOfPlayer(FlatBufferBuilder builder, Span<Offset<Player>> offsets) {
    var comparer = new SortedVectorUtils.VectorOffsetComparer<Player, ByteBuffer, byte>(builder.DataBuffer, 6);
    RefStructSorters.Sort(offsets, ref comparer);
    return builder.CreateVectorOfTables<Player>(offsets);
  }

  public static bool TryGetByKey(int vectorLocation, string key, ByteBuffer bb, out Player value) {
    return SortedVectorUtils.TryGetByKey<Player, ByteBuffer>(vectorLocation, key, ref bb, 6, out value);
  }
  public PlayerT UnPack() {
    var _o = new PlayerT();
    this.UnPackTo(_o);
    return _o;
  }
  public void UnPackTo(PlayerT _o) {
    _o.Id = this.Id;
    _o.Name = this.Name;
    _o.Level = this.Level;
    _o.Health = this.Health;
    if (this.Position.HasValue) {
      if (_o.Position == null) _o.Position = new JsonTest.Vec2T();
      this.Position.Value.UnPackTo(_o.Position);
    } else {
      _o.Position = null;
    }
    _o.Status = this.Status;
    _o.Priorities = this.Priorities;
    var _inventory_vec = this.Inventory;
    var _inventory_len = _inventory_vec.HasValue ? _inventory_vec.Value.Length : 0;
    if (_o.Inventory == null) {
      _o.Inventory = new List<JsonTest.ItemT>(_inventory_len);
    }
    ObjectApiUtil.ResizeList(_o.Inventory, _inventory_len);
    if (_inventory_vec.HasValue) {
      var _inventory_value = _inventory_vec.Value;
      for (var _j = 0; _j < _inventory_len; ++_j) {
        var _src = _inventory_value[_j];
        if (_o.Inventory[_j] == null) { _o.Inventory[_j] = new ItemT(); }
        _src.UnPackTo(_o.Inventory[_j]);
      }
    }
    if (_o.Equipped == null) {
      _o.Equipped = new JsonTest.EquipmentUnion();
    }
    var _EquippedOldType = _o.Equipped.Type;
    _o.Equipped.Type = this.EquippedType;
    switch (this.EquippedType) {
      default:
        _o.Equipped.Value = null;
        break;
      case JsonTest.Equipment.Weapon:
        if (this.Equipped<JsonTest.Weapon>().HasValue) {
          if (_EquippedOldType == JsonTest.Equipment.Weapon) {
            this.Equipped<JsonTest.Weapon>().Value.UnPackTo((JsonTest.WeaponT)_o.Equipped.Value);
          } else {
            _o.Equipped.Value = this.Equipped<JsonTest.Weapon>().Value.UnPack();
          }
        } else {
          _o.Equipped.Value = null;
        }
        break;
      case JsonTest.Equipment.Armor:
        if (this.Equipped<JsonTest.Armor>().HasValue) {
          if (_EquippedOldType == JsonTest.Equipment.Armor) {
            this.Equipped<JsonTest.Armor>().Value.UnPackTo((JsonTest.ArmorT)_o.Equipped.Value);
          } else {
            _o.Equipped.Value = this.Equipped<JsonTest.Armor>().Value.UnPack();
          }
        } else {
          _o.Equipped.Value = null;
        }
        break;
    }
    var _tags_vec = this.Tags;
    var _tags_len = _tags_vec.HasValue ? _tags_vec.Value.Length : 0;
    if (_o.Tags == null) {
      _o.Tags = new List<string>(_tags_len);
    } else {
      _o.Tags.Clear();
      if (_o.Tags.Capacity < _tags_len) {
        _o.Tags.Capacity = _tags_len;
      }
    }
    if (_tags_vec.HasValue) {
      var _tags_value = _tags_vec.Value;
      for (var _j = 0; _j < _tags_len; ++_j) { _o.Tags.Add(_tags_value[_j]); }
    }
    var _scores_vec = this.Scores;
    var _scores_len = _scores_vec.HasValue ? _scores_vec.Value.Length : 0;
    if (_o.Scores == null) {
      _o.Scores = new List<int>(_scores_len);
    }
    ObjectApiUtil.ResizeList(_o.Scores, _scores_len);
    if (_scores_vec.HasValue) { _scores_vec.Value.CopyTo(CollectionsMarshal.AsSpan(_o.Scores)); }
    if (this.Color.HasValue) {
      if (_o.Color == null) _o.Color = new JsonTest.ColorT();
      this.Color.Value.UnPackTo(_o.Color);
    } else {
      _o.Color = null;
    }
  }
  public static Offset<JsonTest.Player> Pack(FlatBufferBuilder builder, PlayerT _o) {
    if (_o == null) return default(Offset<JsonTest.Player>);
    var _name = _o.Name == null ? default(StringOffset) : builder.CreateString(_o.Name);
    var _inventory = default(VectorOffset);
    if (_o.Inventory != null) {
      var _inventory_len = _o.Inventory.Count;
      Offset<JsonTest.Item>[] _inventory_arr = null;
      try {
        Span<Offset<JsonTest.Item>> __inventory = _inventory_len <= 64
          ? stackalloc Offset<JsonTest.Item>[_inventory_len]
          : (_inventory_arr = ArrayPool<Offset<JsonTest.Item>>.Shared.Rent(_inventory_len)).AsSpan(0, _inventory_len);
        for (var _j = 0; _j < _inventory_len; ++_j) { __inventory[_j] = JsonTest.Item.Pack(builder, _o.Inventory[_j]); }
        _inventory = CreateInventoryVector(builder, __inventory);
      } finally {
        if (_inventory_arr != null) { ArrayPool<Offset<JsonTest.Item>>.Shared.Return(_inventory_arr); }
      }
    }
    var _equipped_type = _o.Equipped == null ? JsonTest.Equipment.NONE : _o.Equipped.Type;
    var _equipped = _o.Equipped == null ? 0 : JsonTest.EquipmentUnion.Pack(builder, _o.Equipped);
    var _tags = default(VectorOffset);
    if (_o.Tags != null) {
      var _tags_len = _o.Tags.Count;
      StringOffset[] _tags_arr = null;
      try {
        Span<StringOffset> __tags = _tags_len <= 64
          ? stackalloc StringOffset[_tags_len]
          : (_tags_arr = ArrayPool<StringOffset>.Shared.Rent(_tags_len)).AsSpan(0, _tags_len);
        for (var _j = 0; _j < _tags_len; ++_j) { __tags[_j] = builder.CreateString(_o.Tags[_j]); }
        _tags = CreateTagsVector(builder, __tags);
      } finally {
        if (_tags_arr != null) { ArrayPool<StringOffset>.Shared.Return(_tags_arr); }
      }
    }
    var _scores = default(VectorOffset);
    if (_o.Scores != null) {
      _scores = CreateScoresVector(builder, CollectionsMarshal.AsSpan(_o.Scores));
    }
    return CreatePlayer(
      builder,
      _o.Id,
      _name,
      _o.Level,
      _o.Health,
      _o.Position,
      _o.Status,
      _o.Priorities,
      _inventory,
      _equipped_type,
      _equipped,
      _tags,
      _scores,
      _o.Color);
  }
}

public class PlayerT
{
  [System.Text.Json.Serialization.JsonPropertyName("id")]
  public long Id { get; set; }
  [System.Text.Json.Serialization.JsonPropertyName("name")]
  public string Name { get; set; }
  [System.Text.Json.Serialization.JsonPropertyName("level")]
  public int Level { get; set; }
  [System.Text.Json.Serialization.JsonPropertyName("health")]
  public float Health { get; set; }
  [System.Text.Json.Serialization.JsonPropertyName("position")]
  public JsonTest.Vec2T Position { get; set; }
  [System.Text.Json.Serialization.JsonPropertyName("status")]
  public JsonTest.Status Status { get; set; }
  [System.Text.Json.Serialization.JsonPropertyName("priorities")]
  public JsonTest.Priority Priorities { get; set; }
  [System.Text.Json.Serialization.JsonPropertyName("inventory")]
  public List<JsonTest.ItemT> Inventory { get; set; }
  [System.Text.Json.Serialization.JsonPropertyName("equipped_type")]
  private JsonTest.Equipment EquippedType {
    get {
      return this.Equipped != null ? this.Equipped.Type : JsonTest.Equipment.NONE;
    }
    set {
      this.Equipped = new JsonTest.EquipmentUnion();
      this.Equipped.Type = value;
    }
  }
  [System.Text.Json.Serialization.JsonPropertyName("equipped")]
  [System.Text.Json.Serialization.JsonConverter(typeof(JsonTest.EquipmentUnion_JsonConverter))]
  public JsonTest.EquipmentUnion Equipped { get; set; }
  [System.Text.Json.Serialization.JsonPropertyName("tags")]
  public List<string> Tags { get; set; }
  [System.Text.Json.Serialization.JsonPropertyName("scores")]
  public List<int> Scores { get; set; }
  [System.Text.Json.Serialization.JsonPropertyName("color")]
  public JsonTest.ColorT Color { get; set; }

  public PlayerT() {
    this.Id = 0;
    this.Name = null;
    this.Level = 1;
    this.Health = 100.0f;
    this.Position = new JsonTest.Vec2T();
    this.Status = JsonTest.Status.Active;
    this.Priorities = 0;
    this.Inventory = null;
    this.Equipped = null;
    this.Tags = null;
    this.Scores = null;
    this.Color = new JsonTest.ColorT();
  }
}


static public class PlayerVerify
{
  static public bool Verify(ref Google.FlatSpanBuffers.Verifier verifier, uint tablePos)
  {
    return verifier.VerifyTableStart(tablePos)
      && verifier.VerifyField(tablePos, 4 /*Id*/, 8 /*long*/, 8, false)
      && verifier.VerifyString(tablePos, 6 /*Name*/, true)
      && verifier.VerifyField(tablePos, 8 /*Level*/, 4 /*int*/, 4, false)
      && verifier.VerifyField(tablePos, 10 /*Health*/, 4 /*float*/, 4, false)
      && verifier.VerifyField(tablePos, 12 /*Position*/, 8 /*JsonTest.Vec2*/, 4, false)
      && verifier.VerifyField(tablePos, 14 /*Status*/, 1 /*JsonTest.Status*/, 1, false)
      && verifier.VerifyField(tablePos, 16 /*Priorities*/, 1 /*JsonTest.Priority*/, 1, false)
      && verifier.VerifyVectorOfTables(tablePos, 18 /*Inventory*/, JsonTest.ItemVerify.Verify, false)
      && verifier.VerifyField(tablePos, 20 /*EquippedType*/, 1 /*JsonTest.Equipment*/, 1, false)
      && verifier.VerifyUnion(tablePos, 20, 22 /*Equipped*/, JsonTest.EquipmentVerify.Verify, false)
      && verifier.VerifyVectorOfStrings(tablePos, 24 /*Tags*/, false)
      && verifier.VerifyVectorOfData(tablePos, 26 /*Scores*/, 4 /*int*/, false)
      && verifier.VerifyField(tablePos, 28 /*Color*/, 4 /*JsonTest.Color*/, 1, false)
      && verifier.VerifyTableEnd(tablePos);
  }
}

}
